from flask import Flask, render_template, url_for, request, redirect, session
import sqlite3


app = Flask(__name__)

app.secret_key = b'_5#y2L"F4Q8z\n\xec]/'

@app.route("/")
@app.route("/index.html")
@app.route("/index")
def index():
	return render_template('index.html')

@app.route("/login.html")
@app.route("/login")
def login():
	return render_template('login.html')

@app.route("/no-sidebar.html")
@app.route("/no-sidebar")
def nosidebar():
	return render_template('no-sidebar.html')

@app.route("/sign-up")
@app.route("/sign-up.html")
def signup():
	return render_template('sign-up.html')

@app.route("/sign-up-proc", methods=['POST'])
def signupproc():
	ID = request.form['ID']
	PSW = request.form['PSW']
	member1 = request.form['member1']
	member2 = request.form['member2']
	member3 = request.form['member3']
	Score = 0
	conn = sqlite3.connect('/cand0/cand0/cand0.db')
	cur = conn.cursor()
	sql = "insert into TEAM(ID, PW, Member1, Member2, Member3, Score) values(?,?,?,?,?,?)"
	cur.execute(sql, (ID, PSW, member1, member2, member3, Score))

	conn.commit()
	conn.close()
	return redirect(url_for('index'))


@app.route("/sign-in")
def signin():
	return render_template('sign-in.html')

@app.route("/sign-in-proc", methods=['POST'])
def signinproc():
	conn = sqlite3.connect('/cand0/cand0/cand0.db')
	cur = conn.cursor()
	ID = request.form['ID']
	PW = request.form['PSW']
	cur.execute("select PW from TEAM where TEAM.ID='%s'"%ID)
	rows = cur.fetchall()
	conn.close()

	if rows:
		if PW == rows[0][0]:
			if 'counter' in session:
				session['counter'] +=1
			return "Login Success" + str(result)
		else :
			return "password incorrect"
	else :
		return "no ID"

#if __name__ == '__main__':
#	app.run(host="0.0.0.0", port="5000")
